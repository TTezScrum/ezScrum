*** Settings ***
Documentation     CI 測試不穩定,需加入同步機制?
Suite Setup       Test TaskBoard - Setup
Suite Teardown    Test TaskBoard - Teardown
Force Tags        TaskBoard
Resource          keywords/common_resource.txt
Resource          keywords/ezScrum_Login.txt
Resource          keywords/Project/ezScrum_Project.txt
Resource          keywords/ProductBacklog/ezScrum_ProductBacklog_Story.txt
Resource          keywords/ProductBacklog/ezScrum_ProductBacklog_Tag.txt
Resource          keywords/SprintPlan/ezScrum_SprintPlan_Sprint.txt
Resource          keywords/SprintBacklog/ezScrum_SprintBacklog_Story.txt
Resource          keywords/SprintBacklog/ezScrum_SprintBacklog_Task.txt
Resource          keywords/SprintBacklog/ezScrum_SprintBacklog_Sprint.txt
Resource          keywords/TaskBoard/ezScrum_TaskBoard.txt
Resource          keywords/TaskBoard/ezScrum_TaskBoard_SetupTeardown.txt
Resource          Global Define.txt
Resource          ServerConfig.txt
Library           BuiltIn
Library           Collections
Library           keywords/lib/Selenium2Improved.py
Resource          keywords/TaskBoard/ezScrum_TaskBoard_AttachFile_SetupTeardown.txt
Library           keywords/lib/DatabaseHandler.py

*** Test Cases ***
Test TaskBoard - Sprint Information
    [Documentation]    驗證TaskBoard頁面，有關於Sprint Information的資料是否正確
    [Tags]    Unstable
    [Setup]    Test TaskBoard - Sprint Information Setup
    Select Node Product    TaskBoard
    # Verify sprint information
    Compare Field Content    //div[@id="TaskBoard_Page"]//input[@name="SprintGoal"]    TaskBoard AT
    Compare Field Content    //div[@id="TaskBoard_Page"]//label[text()="Handler:"]/..//input[@type="text"]    ALL
    Compare Field Content    //div[@id="TaskBoard_Page"]//label[text()="Sprint ID:"]/..//input[@type="text"]    Sprint #${tcStoryID}
    Compare Field Content    //div[@id="TaskBoard_Page"]//input[@name="CurrentStoryPoint"]    2
    Compare Field Content    //div[@id="TaskBoard_Page"]//input[@name="CurrentTaskPoint"]    ${tcTaskEstimate}
    Compare Field Content    //div[@id="TaskBoard_Page"]//input[@name="ReleaseID"]    None
    # Verify taskcard information
    # story information
    ${_TempStoryName}=    Get Text    xpath=//div[@id="${tcStoryID}_new"]//table[@class="StoryCard_Header"]//td[1]/h2[text()="[Story]\ \ #${tcStoryID}"]/../../../../../../../..//td[@class="StroyCard_Description"]
    ${_TempStoryEstimate}=    Get Text    xpath=//div[@id="${tcStoryID}_new"]//table[@class="StoryCard_Header"]//td[1]/h2[text()="[Story]\ \ #${tcStoryID}"]/../../../../../../../..//td[@class="StoryCard_Value"]
    Should Be Equal As Strings    ${_TempStoryName}    ${tcStoryName}
    Should Be Equal    ${_TempStoryEstimate}    ${tcStoryEstimate} Point    # x Point
    # variables
    Verify Story Information With Arguments In TaskBoard    ${tcStoryID}    ${tcStoryName}    ${tcStoryValue}    ${tcStoryEstimate}    ${tcStoryImportance}    ${EMPTY}
    ...    ${tcStoryNotes}    ${tcStoryHowToDemo}
    # task information
    ${_TempTaskName}=    Get Text    xpath=//div[@id="${tcStoryID}_new"]//table[@class="TaskCard_Header"]//td[2]/h2[text()="[Task]\ \ #${tcTaskID}"]/../../../../../../../..//td[@class="TaskCard_Description"]
    ${_TempTaskEstimate}=    Get Text    xpath=//div[@id="${tcStoryID}_new"]//table[@class="TaskCard_Header"]//td[2]/h2[text()="[Task]\ \ #${tcTaskID}"]/../../../../../../../..//td[@class="TaskCard_Value"]
    Should Be Equal As Strings    ${_TempTaskName}    ${tcTaskName}
    Should Be Equal    ${_TempTaskEstimate}    ${tcTaskEstimate} hr    # x hr
    # Variable
    Set Test Variable    ${tcTaskName}    task 1 for test Sprint Information
    Set Test Variable    ${tcTaskEstimate}    3
    Set Test Variable    ${tcTaskNotes}    notes for test Sprint Information
    Verify Task Information With Arguments In TaskBoard    ${tcTaskID}    ${tcTaskName}    ${EMPTY}    ${EMPTY}    ${tcTaskEstimate}    ${tcTaskEstimate}
    ...    0    ${tcTaskNotes}
    [Teardown]    Test TaskBoard - Sprint Information Teardown

Test TaskBoard - Task Checked Out
    [Documentation]    驗證TaskBoard頁面，有關於 Task 從 Not Checked Out 拖拉至 Checked Out 後，資料是否正確
    [Tags]    Unstable
    [Setup]    Test TaskBoard - Task Checked Out Setup
    Comment    Set Selenium Speed    ${SELENIUM_SPEED_SLOW}
    Select Node Product    TaskBoard
    Task Checked Out With Arguments    ${tcStoryID}    ${tcTaskID}
    # Verify taskcard information
    ${_TaskHandler}=    Set Variable    admin
    ${_TempTaskDescription}=    Get Text    xpath=//div[@id="${tcStoryID}_assigned"]//table[@class="TaskCard_Header"]//td[2]/h2[text()="[Task]\ \ #${tcTaskID}"]/../../../../../../../..//td[@class="TaskCard_Description"]
    ${_TempTaskEstimate}=    Get Text    xpath=//div[@id="${tcStoryID}_assigned"]//table[@class="TaskCard_Header"]//td[2]/h2[text()="[Task]\ \ #${tcTaskID}"]/../../../../../../../..//td[@class="TaskCard_Value"]
    ${_TempTaskHandler}=    Get Text    xpath=//div[@id="${tcStoryID}_assigned"]//table[@class="TaskCard_Header"]//td[2]/h2[text()="[Task]\ \ #${tcTaskID}"]/../../../../../../../..//span[@class="TaskCard_Handler"]
    Should Be Equal As Strings    ${_TempTaskDescription}    task 1 for test task Checked Out
    Should Be Equal    ${_TempTaskEstimate}    3 hr    # x hr
    Should Be Equal As Strings    ${_TempTaskHandler}    ${_TaskHandler}
    Select Node Product    Sprint Backlog
    Xpath Should Match X Times    //td[@class="x-treegrid-col"]/a/span[text()="${tcStoryID}"]/../../../../tr[2]//div[text()="${tcTaskName}"]/../../td[3]/div[text()="${tcTaskName}"]    1
    Xpath Should Match X Times    //td[@class="x-treegrid-col"]/a/span[text()="${tcStoryID}"]/../../../../tr[2]//div[text()="${tcTaskName}"]/../../td[6]/div[text()="${tcTaskEstimate}"]    1
    Xpath Should Match X Times    //td[@class="x-treegrid-col"]/a/span[text()="${tcStoryID}"]/../../../../tr[2]//div[text()="${tcTaskName}"]/../../td[7]/div[text()="${_TaskHandler}"]    1
    Xpath Should Match X Times    //td[@class="x-treegrid-col"]/a/span[text()="${tcStoryID}"]/../../../../tr[2]//div[text()="${tcTaskName}"]/../../td[8]/div[text()="assigned"]    1
    [Teardown]    Test TaskBoard - Task Checked Out Teardown

Test TaskBoard - Task Done
    [Documentation]    驗證TaskBoard頁面，有關於 Task 從 Checked Out 拖拉至 Done 後，資料是否正確
    [Tags]    Unstable
    [Setup]    Test TaskBoard - Task Done Setup
    Set Selenium Speed    ${SELENIUM_SPEED_SLOW}
    Select Node Product    TaskBoard
    Task Checked Out With Arguments    ${tcStoryID}    ${tcTaskID}
    Task Done With Arguments    ${tcStoryID}    ${tcTaskID}
    # Verify taskcard information
    ${_TaskHandler}=    Set Variable    admin
    ${_TempTaskDescription}=    Get Text    xpath=//div[@id="${tcStoryID}_closed"]//table[@class="TaskCard_Header"]//td[2]/h2[text()="[Task]\ \ #${tcTaskID}"]/../../../../../../../..//td[@class="TaskCard_Description"]
    ${_TempTaskEstimate}=    Get Text    xpath=//div[@id="${tcStoryID}_closed"]//table[@class="TaskCard_Header"]//td[2]/h2[text()="[Task]\ \ #${tcTaskID}"]/../../../../../../../..//td[@class="TaskCard_Value"]
    ${_TempTaskHandler}=    Get Text    xpath=//div[@id="${tcStoryID}_closed"]//table[@class="TaskCard_Header"]//td[2]/h2[text()="[Task]\ \ #${tcTaskID}"]/../../../../../../../..//span[@class="TaskCard_Handler"]
    Should Be Equal As Strings    ${_TempTaskDescription}    ${tcTaskName}
    Should Be Equal    ${_TempTaskEstimate}    0 hr    # x hr
    Should Be Equal As Strings    ${_TempTaskHandler}    ${_TaskHandler}
    Select Node Product    Sprint Backlog
    Xpath Should Match X Times    //td[@class="x-treegrid-col"]/a/span[text()="${tcStoryID}"]/../../../../tr[2]//div[text()="${tcTaskName}"]/../../td[3]/div[text()="${tcTaskName}"]    1
    Xpath Should Match X Times    //td[@class="x-treegrid-col"]/a/span[text()="${tcStoryID}"]/../../../../tr[2]//div[text()="${tcTaskName}"]/../../td[6]/div[text()="${tcTaskEstimate}"]    1
    Xpath Should Match X Times    //td[@class="x-treegrid-col"]/a/span[text()="${tcStoryID}"]/../../../../tr[2]//div[text()="${tcTaskName}"]/../../td[7]/div[text()="${_TaskHandler}"]    1
    Xpath Should Match X Times    //td[@class="x-treegrid-col"]/a/span[text()="${tcStoryID}"]/../../../../tr[2]//div[text()="${tcTaskName}"]/../../td[8]/div[text()="closed"]    1
    [Teardown]    Test TaskBoard - Task Done Teardown

Test TaskBoard - Task ReOpen
    [Documentation]    驗證TaskBoard頁面，有關於 Task 從 Done 拖拉至 Not Checked Out 後，資料是否正確
    [Tags]    Unstable
    [Setup]    Test TaskBoard - Task ReOpen Setup
    Set Selenium Speed    ${SELENIUM_SPEED_SLOW}
    Select Node Product    TaskBoard
    Task Checked Out With Arguments    ${tcStoryID}    ${tcTaskID}
    Task Done With Arguments    ${tcStoryID}    ${tcTaskID}
    Task ReOpen With Arguments    ${tcStoryID}    ${tcTaskID}
    # Verify taskcard information
    ${_TaskHandler}=    Set Variable    admin
    ${_TempTaskDescription}=    Get Text    xpath=//div[@id="${tcStoryID}_assigned"]//table[@class="TaskCard_Header"]//td[2]/h2[text()="[Task]\ \ #${tcTaskID}"]/../../../../../../../..//td[@class="TaskCard_Description"]
    ${_TempTaskEstimate}=    Get Text    xpath=//div[@id="${tcStoryID}_assigned"]//table[@class="TaskCard_Header"]//td[2]/h2[text()="[Task]\ \ #${tcTaskID}"]/../../../../../../../..//td[@class="TaskCard_Value"]
    ${_TempTaskHandler}=    Get Text    xpath=//div[@id="${tcStoryID}_assigned"]//table[@class="TaskCard_Header"]//td[2]/h2[text()="[Task]\ \ #${tcTaskID}"]/../../../../../../../..//span[@class="TaskCard_Handler"]
    Should Be Equal As Strings    ${_TempTaskDescription}    ${tcTaskName}
    Should Be Equal    ${_TempTaskEstimate}    0 hr    # x hr
    Should Be Equal As Strings    ${_TempTaskHandler}    ${_TaskHandler}
    Select Node Product    Sprint Backlog
    Xpath Should Match X Times    //td[@class="x-treegrid-col"]/a/span[text()="${tcStoryID}"]/../../../../tr[2]//div[text()="${tcTaskName}"]/../../td[3]/div[text()="${tcTaskName}"]    1
    Xpath Should Match X Times    //td[@class="x-treegrid-col"]/a/span[text()="${tcStoryID}"]/../../../../tr[2]//div[text()="${tcTaskName}"]/../../td[6]/div[text()="${tcTaskEstimate}"]    1
    Xpath Should Match X Times    //td[@class="x-treegrid-col"]/a/span[text()="${tcStoryID}"]/../../../../tr[2]//div[text()="${tcTaskName}"]/../../td[7]/div[text()="${_TaskHandler}"]    1
    Xpath Should Match X Times    //td[@class="x-treegrid-col"]/a/span[text()="${tcStoryID}"]/../../../../tr[2]//div[text()="${tcTaskName}"]/../../td[8]/div[text()="assigned"]    1
    [Teardown]    Test TaskBoard - Task ReOpen Teardown

Test TaskBoard - Task ReChecked Out
    [Documentation]    驗證TaskBoard頁面，有關於 Task 從 Checked Out \ 拖拉至 Not Checked Out 後，資料是否正確
    [Tags]    Unstable
    [Setup]    Test TaskBoard - Task ReChecked Out Setup
    Set Selenium Speed    ${SELENIUM_SPEED_SLOW}
    Select Node Product    TaskBoard
    Task Checked Out With Arguments    ${tcStoryID}    ${tcTaskID}
    Task Done With Arguments    ${tcStoryID}    ${tcTaskID}
    Task ReOpen With Arguments    ${tcStoryID}    ${tcTaskID}
    Task ReChecked Out With Arguments    ${tcStoryID}    ${tcTaskID}
    # Verify taskcard information
    ${_TaskHandler}=    Set Variable    admin
    ${_TempTaskDescription}=    Get Text    xpath=//div[@id="${tcStoryID}_new"]//table[@class="TaskCard_Header"]//td[2]/h2[text()="[Task]\ \ #${tcTaskID}"]/../../../../../../../..//td[@class="TaskCard_Description"]
    ${_TempTaskEstimate}=    Get Text    xpath=//div[@id="${tcStoryID}_new"]//table[@class="TaskCard_Header"]//td[2]/h2[text()="[Task]\ \ #${tcTaskID}"]/../../../../../../../..//td[@class="TaskCard_Value"]
    Should Be Equal As Strings    ${_TempTaskDescription}    ${tcTaskName}
    Should Be Equal    ${_TempTaskEstimate}    0 hr    # x hr
    Select Node Product    Sprint Backlog
    Xpath Should Match X Times    //td[@class="x-treegrid-col"]/a/span[text()="${tcStoryID}"]/../../../../tr[2]//div[text()="${tcTaskName}"]/../../td[3]/div[text()="${tcTaskName}"]    1
    Xpath Should Match X Times    //td[@class="x-treegrid-col"]/a/span[text()="${tcStoryID}"]/../../../../tr[2]//div[text()="${tcTaskName}"]/../../td[6]/div[text()="${tcTaskEstimate}"]    1
    Xpath Should Match X Times    //td[@class="x-treegrid-col"]/a/span[text()="${tcStoryID}"]/../../../../tr[2]//div[text()="${tcTaskName}"]/../../td[7]/div[text()="${_TaskHandler}"]    0
    Xpath Should Match X Times    //td[@class="x-treegrid-col"]/a/span[text()="${tcStoryID}"]/../../../../tr[2]//div[text()="${tcTaskName}"]/../../td[8]/div[text()="new"]    1
    [Teardown]    Test TaskBoard - Task ReChecked Out Teardown

Test TaskBoard - Story Done
    [Documentation]    驗證TaskBoard頁面，有關於 Story 從 Not Checked Out 拖拉至 Done 後，資料是否正確
    [Tags]    Unstable
    [Setup]    Test TaskBoard - Story Done Setup
    Set Selenium Speed    ${SELENIUM_SPEED_SLOW}
    Select Node Product    TaskBoard
    Task Checked Out With Arguments    ${tcStoryID}    ${tcTaskID}
    Task Done With Arguments    ${tcStoryID}    ${tcTaskID}
    Story Done With Arguments    ${tcStoryID}
    # Verify taskcard information
    ${_TempStoryDescription}=    Get Text    xpath=//div[@id="${tcStoryID}_closed"]//table[@class="StoryCard_Header"]//td[1]/h2[text()="[Story]\ \ #${tcStoryID}"]/../../../../../../../..//td[@class="StroyCard_Description"]
    ${_TempStoryEstimate}=    Get Text    xpath=//div[@id="${tcStoryID}_closed"]//table[@class="StoryCard_Header"]//td[1]/h2[text()="[Story]\ \ #${tcStoryID}"]/../../../../../../../..//td[@class="StoryCard_Value"]
    Should Be Equal As Strings    ${_TempStoryDescription}    ${tcStoryName}
    Should Be Equal    ${_TempStoryEstimate}    ${tcStoryEstimate} Point    # x Point
    Select Node Product    Sprint Backlog
    Xpath Should Match X Times    //div[text()="story for taskboard AT"]/../../td[8]/div[text()="closed"]    1
    [Teardown]    Test TaskBoard - Story Done Teardown

Test TaskBoard - Story ReOpen
    [Documentation]    驗證TaskBoard頁面，有關於 Story 從 Done 拖拉至 Not Checked Out 後，資料是否正確
    [Tags]    Unstable
    [Setup]    Test TaskBoard - Story ReOpen Setup
    Set Selenium Speed    ${SELENIUM_SPEED_SLOW}
    Select Node Product    TaskBoard
    Task Checked Out With Arguments    ${tcStoryID}    ${tcTaskID}
    Task Done With Arguments    ${tcStoryID}    ${tcTaskID}
    Story Done With Arguments    ${tcStoryID}
    Story Reopen With Arguments    ${tcStoryID}
    # Verify taskcard information
    ${_TempStoryDescription}=    Get Text    xpath=//div[@id="${tcStoryID}_new"]//table[@class="StoryCard_Header"]//td[1]/h2[text()="[Story]\ \ #${tcStoryID}"]/../../../../../../../..//td[@class="StroyCard_Description"]
    ${_TempStoryEstimate}=    Get Text    xpath=//div[@id="${tcStoryID}_new"]//table[@class="StoryCard_Header"]//td[1]/h2[text()="[Story]\ \ #${tcStoryID}"]/../../../../../../../..//td[@class="StoryCard_Value"]
    Should Be Equal As Strings    ${_TempStoryDescription}    ${tcStoryName}
    Should Be Equal    ${_TempStoryEstimate}    ${tcStoryEstimate} Point    # x Point
    Select Node Product    Sprint Backlog
    Xpath Should Match X Times    //div[text()="story for taskboard AT"]/../../td[8]/div[text()="new"]    1
    #//td[@class="x-treegrid-col"]/a/span[text()="${tcStoryID}"]/../../..//td[8]/div[text()="new"]
    [Teardown]    Test TaskBoard - Story ReOpen Teardown

Test TaskBoard - Story Done But All the tasks of Story are not Done in Not Checked Out Stage
    [Documentation]    驗證TaskBoard頁面，有關於 Story 從 Not Checked Out 拖拉至 Checked Out 後，
    ...    但是 tasks 是放置 Stage of Not Checked Out，驗證是否跳出警告視窗。
    [Tags]    Unstable
    [Setup]    Test TaskBoard - Story Done But All the tasks of Story are not Done Setup
    Set Selenium Speed    ${SELENIUM_SPEED_SLOW}
    Select Node Product    TaskBoard
    Wait Until Page Contains Element    xpath=//div[@id="${tcStoryID}_new"]//table[@class="StoryCard_Header"]//td[1]/h2[text()="[Story]\ \ #${tcStoryID}"]/../../../../../../../..
    Wait Until Page Contains Element    xpath=//div[@id="${tcStoryID}_closed"]/div
    Comment    Assign Id To Element    xpath=//div[@id="${tcStoryID}_closed"]/div    doneStageID
    Comment    Drag And Drop    xpath=//div[@id="${tcStoryID}_new"]//table[@class="StoryCard_Header"]//td[1]/h2[text()="[Story]\ \ #${tcStoryID}"]/../../../../../../../..    target=doneStageID
    Drag And Drop    xpath=//div[@id="${tcStoryID}_new"]//table[@class="StoryCard_Header"]//td[1]/h2[text()="[Story]\ \ #${tcStoryID}"]/../../../../../../../..    target=${tcStoryID}_closed
    Sleep    5s
    Wait Until Page Contains    warning!
    Wait Until Page Contains    Please check all the tasks of Story #${tcStoryID} are done.
    ${xpathOKButton}=    Find Current Window Element    warning!    OK
    Element Enable And Submit    ${xpathOKButton}
    # Verify taskcard information
    ${_TempStoryDescription}=    Get Text    xpath=//div[@id="${tcStoryID}_new"]//table[@class="StoryCard_Header"]//td[1]/h2[text()="[Story]\ \ #${tcStoryID}"]/../../../../../../../..//td[@class="StroyCard_Description"]
    ${_TempStoryEstimate}=    Get Text    xpath=//div[@id="${tcStoryID}_new"]//table[@class="StoryCard_Header"]//td[1]/h2[text()="[Story]\ \ #${tcStoryID}"]/../../../../../../../..//td[@class="StoryCard_Value"]
    Should Be Equal As Strings    ${_TempStoryDescription}    ${tcStoryName}
    Should Be Equal    ${_TempStoryEstimate}    ${tcStoryEstimate} Point    # x Point
    Select Node Product    Sprint Backlog
    Xpath Should Match X Times    //div[text()="story for taskboard AT"]/../../td[8]/div[text()="new"]    1
    #//td[@class="x-treegrid-col"]/a/span[text()="${tcStoryID}"]/../../..//td[8]/div[text()="new"]
    [Teardown]    Test TaskBoard - Story Done But All the tasks of Story are not Done Teardown

Test TaskBoard - Story Done But All the tasks of Story are not Done in Checked Out Stage
    [Documentation]    驗證TaskBoard頁面，有關於 Story 從 Not Checked Out 拖拉至 Checked Out 後，
    ...    但是 tasks 是放置 Stage of Checked Out，驗證是否跳出警告視窗。
    [Tags]    Unstable
    [Setup]    Test TaskBoard - Story Done But All the tasks of Story are not Done Setup
    Set Selenium Speed    ${SELENIUM_SPEED_SLOW}
    Select Node Product    TaskBoard
    Task Checked Out With Arguments    ${tcStoryID}    ${tcTaskID}
    Drag And Drop    xpath=//div[@id="${tcStoryID}_new"]//table[@class="StoryCard_Header"]//td[1]/h2[text()="[Story]\ \ #${tcStoryID}"]/../../../../../../../..    target=${tcStoryID}_closed
    Wait Until Page Contains    warning!
    Wait Until Page Contains    Please check all the tasks of Story #${tcStoryID} are done.
    ${xpathOKButton}=    Find Current Window Element    warning!    OK
    Element Enable And Submit    ${xpathOKButton}
    # Verify taskcard information
    ${_TempStoryDescription}=    Get Text    xpath=//div[@id="${tcStoryID}_new"]//table[@class="StoryCard_Header"]//td[1]/h2[text()="[Story]\ \ #${tcStoryID}"]/../../../../../../../..//td[@class="StroyCard_Description"]
    ${_TempStoryEstimate}=    Get Text    xpath=//div[@id="${tcStoryID}_new"]//table[@class="StoryCard_Header"]//td[1]/h2[text()="[Story]\ \ #${tcStoryID}"]/../../../../../../../..//td[@class="StoryCard_Value"]
    Should Be Equal As Strings    ${_TempStoryDescription}    ${tcStoryName}
    Should Be Equal    ${_TempStoryEstimate}    ${tcStoryEstimate} Point    # x Point
    Select Node Product    Sprint Backlog
    Xpath Should Match X Times    //div[text()="story for taskboard AT"]/../../td[8]/div[text()="new"]    1
    [Teardown]    Test TaskBoard - Story Done But All the tasks of Story are not Done Teardown

Test TaskBoard - Attach File on Story
    [Setup]    Test TaskBoard_AttachFile - Setup
    Page Should Contain    TestProject01
    Click Element    //div[text()="TestProject01"]
    Select Node Product    TaskBoard
    #Attach file to Story
    Click Element    //td[@class='StroyCard_Description']/h1[text()='story01']/../../../tr/td/table/tbody/tr/td[2]/a[@title='Upload File']/img
    ${attachFilePath}=    Catenate    SEPARATOR=\\    ${EXECDIR}    TestData    TaskBoard    Story01AttachFile.txt
    Choose File    //input[@name="file"]    ${attachFilePath}
    Click button    //button[text()="Submit"]
    Wait Until Page Contains    Success.
    Wait Until Element Is Visible    //td[@class='StroyCard_Description']/h1[text()='story01']/../../../tr/td/p/a[@target='_blank']
    ${fileName1} =    Get Text    xpath=//table[@class="StoryCard_Table"]/tbody/tr[3]/td/p[2]/a[1]
    Should Be Equal    ${fileName1}    Story01AttachFile.txt
    [Teardown]    Test TaskBoard_AttachFile - Teardown on Story

Test TaskBoard - Attach File on Task
    [Setup]    Test TaskBoard_AttachFile - Setup
    Page Should Contain    TestProject01
    Click Element    //div[text()="TestProject01"]
    Select Node Product    TaskBoard
    #Attach file to Task
    Wait Until Element Is Visible    //td[@class='TaskCard_Description']/h1[text()='task02']/../../../tr/td/table/tbody/tr/td[3]/a[@title='Upload File']
    Click Element    //td[@class='TaskCard_Description']/h1[text()='task02']/../../../tr/td/table/tbody/tr/td[3]/a[@title='Upload File']
    ${attachFilePath}=    Catenate    SEPARATOR=\\    ${EXECDIR}    TestData    TaskBoard    Task02AttachFile.txt
    Choose File    //input[@name="file"]    ${attachFilePath}
    Click Button    //button[text()="Submit"]
    Wait Until Page Contains    Success.
    Wait Until Element Is Visible    //td[@class='TaskCard_Description']/h1[text()='task02']/../../../tr/td/p/a[@target='_blank']
    ${fileName2} =    Get Text    //td[@class='TaskCard_Description']/h1[text()='task02']/../../../tr/td/p/a[@target='_blank']
    Should Be Equal    Task02AttachFile.txt    ${fileName2}
    [Teardown]    Test TaskBoard_AttachFile - Teardown on Task

Test TaskBoard - Task Done with partner
    [Setup]    Test TaskBoard - Task Done with Partner Setup
    Select Node Product    TaskBoard
    Click Element    xpath=//div[@id="1_assigned"]//table[@class="TaskCard_Header"]//td[3]/a[1]/img
    Compare Field Content    //input[@name="Name"]    Task02
    Compare Field Content    //input[@name="HandlerComboBox_ForEditTask"]    Acount01
    Compare Field Content    //input[@name="Partners"]    Acount02
    Compare Field Content    //input[@name="Estimate"]    5
    Compare Field Content    //input[@name="Remains"]    5
    Click Element    xpath=//button[text()="Cancel"]
    Drag And Drop    xpath=//div[@id="1_assigned"]//table[@class="TaskCard_Header"]//td[2]/h2[text()="[Task]\ \ #2"]/../../../../../../../..    target=1_closed
    Click Element    xpath=//button[text()="Done"]
    Wait Until Page Contains    Success.
    Click Element    xpath=//div[@id="1_closed"]//table[@class="TaskCard_Header"]//td[3]/a[1]/img
    Compare Field Content    //input[@name="Name"]    Task02
    Compare Field Content    //input[@name="HandlerComboBox_ForEditTask"]    Acount01
    Compare Field Content    //input[@name="Partners"]    Acount02
    Compare Field Content    //input[@name="Estimate"]    5
    Compare Field Content    //input[@name="Remains"]    0
    Click Element    xpath=//button[text()="Cancel"]
    [Teardown]    Test TaskBoard - Task Done with Partner Teardown

Test TaskBoard - Check Task Checked Out
    [Setup]    Test TaskBoard - Task Checked Out Setup
    Select Node Product    TaskBoard
    Select Node Product    Sprint Backlog
    Select Node Product    TaskBoard
    Task Checked Out With Arguments    ${tcStoryID}    ${tcTaskID}
    # Verify taskcard information
    ${_TaskHandler}=    Set Variable    admin
    ${_TempTaskDescription}=    Get Text    xpath=//div[@id="${tcStoryID}_assigned"]//table[@class="TaskCard_Header"]//td[2]/h2[text()="[Task]\ \ #${tcTaskID}"]/../../../../../../../..//td[@class="TaskCard_Description"]
    ${_TempTaskEstimate}=    Get Text    xpath=//div[@id="${tcStoryID}_assigned"]//table[@class="TaskCard_Header"]//td[2]/h2[text()="[Task]\ \ #${tcTaskID}"]/../../../../../../../..//td[@class="TaskCard_Value"]
    ${_TempTaskHandler}=    Get Text    xpath=//div[@id="${tcStoryID}_assigned"]//table[@class="TaskCard_Header"]//td[2]/h2[text()="[Task]\ \ #${tcTaskID}"]/../../../../../../../..//span[@class="TaskCard_Handler"]
    Should Be Equal As Strings    ${_TempTaskDescription}    task 1 for test task Checked Out
    Should Be Equal    ${_TempTaskEstimate}    3 hr    # x hr
    Should Be Equal As Strings    ${_TempTaskHandler}    ${_TaskHandler}
    Select Node Product    Sprint Backlog
    Select Node Product    TaskBoard
    Xpath Should Match X Times    //td[@class="x-treegrid-col"]/a/span[text()="${tcStoryID}"]/../../../../tr[2]//div[text()="${tcTaskName}"]/../../td[3]/div[text()="${tcTaskName}"]    1
    Xpath Should Match X Times    //td[@class="x-treegrid-col"]/a/span[text()="${tcStoryID}"]/../../../../tr[2]//div[text()="${tcTaskName}"]/../../td[6]/div[text()="${tcTaskEstimate}"]    1
    Xpath Should Match X Times    //td[@class="x-treegrid-col"]/a/span[text()="${tcStoryID}"]/../../../../tr[2]//div[text()="${tcTaskName}"]/../../td[7]/div[text()="${_TaskHandler}"]    1
    Xpath Should Match X Times    //td[@class="x-treegrid-col"]/a/span[text()="${tcStoryID}"]/../../../../tr[2]//div[text()="${tcTaskName}"]/../../td[8]/div[text()="assigned"]    1
    [Teardown]    Test TaskBoard - Task Checked Out Teardown

Tset TaskBoard - ReleaseID Check
    [Setup]    Test TaskBoard - Initial Release ID Check Setup
    Select Node Product    TaskBoard
    Compare Field Content    //input[@name="ReleaseID"]    None
    [Teardown]    Test TaskBoard - Initial Release ID Check Teardown

Test TaskBoard - Check Task Consistency After Dragging
    [Setup]    Test TaskBoard - Check Task Consistency After Dragging Setup
    ${storyID}=    Set Variable    3
    ${taskID}=    Set Variable    9
    Wait Until Page Contains Element    xpath=//div[@id="Task:${taskID}"]//table[@class="TaskCard_Header"]
    ${TaskCardContent}=    Get Text    xpath=//div[@id="Task:${taskID}"]//td[@class="TaskCard_Description"]
    ${TaskCardHandler}=    Get Text    //div[@id="Task:${taskID}"]//span[@class="TaskCard_Handler"]
    Task Done With Arguments    ${storyID}    ${taskID}
    Check TaskCard Contents    ${taskID}    ${TaskCardContent}    ${TaskCardHandler}    0 hr
    [Teardown]    Test TaskBoard - Check Task Consistency After Dragging Teardown

Test TaskBoard - Check Task ID On The Window After Dragging
    [Documentation]    Try to move TaskBoard between "not Check Out", "Check Out", "Done", and check their ID and Name doesn't change in the windows
    [Setup]    Test TaskBoard - Check TaskBoard ID And Name Setup
    ${Story_ID}=    Set Variable    1
    ${Task_ID}=    Set Variable    4
    ${Task_NotCheckOut}    Set Variable    xpath=//div[@id="${Story_ID}_new"]//h2[text()="[Task] \ #${Task_ID}"]
    Wait until Page Contains Element    ${Task_NotCheckOut}
    ${initialTaskName}=    Get Text    xpath=//div[@id="${Story_ID}_new"]//h2[text()="[Task] \ #${Task_ID}"]/../../../../../../..//td[@class="TaskCard_Description"]/h1
    Move Task From Not Check Out To Check Out Check ID Before Click Done    ${Story_ID}    ${Task_ID}    ${initialTaskName}
    Move Task From Check Out To Done Check ID Before Click Done    ${Story_ID}    ${Task_ID}    ${initialTaskName}
    Move Task From Done To Check Out Check ID Before Click Done    ${Story_ID}    ${Task_ID}    ${initialTaskName}
    Move Task From Check Out To Not Check Out Check ID Before Click Done    ${Story_ID}    ${Task_ID}    ${initialTaskName}
    [Teardown]    Test TaskBoard - Check TaskBoard ID And Name Teardown

Test TaskBoard - Check Sprint ID
    [Setup]    Test TaskBoard - Check Sprint ID Setup
    ${sprintInitialID}=    Get Value    //label[text()="Sprint ID:"]/../div[1]/div/input
    ${sprintIDSelect}=    Set Variable    //label[text()="Sprint ID:"]/../div[1]/div/input
    Click Element    ${sprintIDSelect}
    ${selectSprint2}=    Set Variable    //div[@class="x-layer x-combo-list "]//div[text()="Sprint #2"]
    Click Element    ${selectSprint2}
    ${sprintBaxklog}=    Set Variable    //ul[@class="x-tree-root-ct x-tree-no-lines"]//span[text()="Sprint Backlog"]
    Click Element    ${sprintBaxklog}
    ${taskBoard}=    Set Variable    //ul[@class="x-tree-root-ct x-tree-no-lines"]//span[text()="TaskBoard"]
    Click Element    ${taskBoard}
    ${sprntModernID}=    Get Value    //label[text()="Sprint ID:"]/../div[1]/div/input
    Should Be Equal    ${sprintInitialID}    ${sprntModernID}
    [Teardown]    Test TaskBoard - Check Sprint ID Teardown

Test TaskBoard - Check Task Consistency After Editing in Done Area
    [Setup]    Test TaskBoard - Check Task Consistency After Editing in Done Area Setup
    ${storyID}=    Set Variable    3
    ${taskID}=    Set Variable    9
    Wait Until Page Contains Element    //div[@id="Task:${taskID}"]//table[@class="TaskCard_Header"]
    ${TaskCardContent}=    Get Text    //div[@id="Task:${taskID}"]//td[@class="TaskCard_Description"]
    ${TaskCardHandler}=    Get Text    //div[@id="Task:${taskID}"]//span[@class="TaskCard_Handler"]
    ${TaskCardHours}=    Get Text    //div[@id="Task:${taskID}"]//td[@class="TaskCard_Value"]
    Task Done With Arguments    ${storyID}    ${taskID}
    click element    //div[@id="Task:${taskID}"]//img[@src="images/edit.png"]
    ${_XpathEditTaskSubmit}=    Find Current Window Element    Edit Task #${TaskID}    Submit
    Element Enable And Submit    ${_XpathEditTaskSubmit}
    Page Should Contain Element    //div[@id="${storyID}_closed"]//div[@id="Task:${taskID}"]
    Check TaskCard Contents    ${taskID}    ${TaskCardContent}    ${TaskCardHandler}    0 hr
    [Teardown]    Test TaskBoard - Check Task Consistency After Editing in Done Area Teardown

Test TaskBoard - Check Taskcard Position
    [Documentation]    Check if taskcard position right after moving it from check out \ to done
    [Setup]    Test TaskBoard - Check Task Consistency After Editing in Done Area Setup
    Wait until Page Contains Element    xpath=//iframe[@class="chartjs-hidden-iframe"]    10
    ${Story_ID}=    Set Variable    3
    ${Task_number}=    Set Variable    9
    Move Task From Check Out To Done    ${Story_ID}     ${Task_number}
    Reload Page
    Select Node Product    TaskBoard
    Check if Done column has TaskCard    ${Story_ID}     ${Task_number}
    [Teardown]    Test TaskBoard - Check Task Consistency After Editing in Done Area Teardown
