*** Settings ***
Suite Setup
Suite Teardown
Library           BuiltIn
Library           keywords/lib/Selenium2Improved.py
Library           Collections
Resource          Global Define.txt
Resource          ServerConfig.txt
Library           keywords/lib/DatabaseHandler.py
Resource          keywords/Tag/ezScrum_Tag_SetupTeardown.txt

*** Test Cases ***
Test Tag - ProductBacklog Add Tag with Edit Story
    [Setup]    Test Tag - ProductBacklog Add Tag with Edit Story Setup
    Click Element    //div[@id="ProductBacklog_Page"]//div[text()="Story01"]/../../..
    Click Element    //button[text()="Edit Story"]
    Click Element    //label[text()="Tags:"]/..//img
    Click Element    //span[text()="Project02Tag01"]
    Click Element    //label[text()="Tags:"]
    Click Element    //button[text()="Submit"]
    Compare Field Content    //div[text()="Story01"]/../..//div[@class="x-grid3-cell-inner x-grid3-col-2"]    Project02Tag01
    [Teardown]    Test Tag - ProductBacklog Add Tag with Edit Story Teardown

Test Tag - Add Mutiple Tags with Tag Button
    [Setup]    Test Tag - Add Mutiple Tags with Tag Button Setup
    Click Element    //div[@id="ProductBacklog_Page"]//div[text()="Story02"]/../../..
    Click Element    //button[text()="Tag"]
    Click Element    //span[text()="Project02Tag01"]
    Click Element    //div[@id="ProductBacklog_Page"]//div[text()="Story02"]/../../..
    Wait Until Element Contains    //div[text()="Story02"]/../..//div[@class="x-grid3-cell-inner x-grid3-col-2"]    Project02Tag01
    Compare Field Content    //div[text()="Story02"]/../..//div[@class="x-grid3-cell-inner x-grid3-col-2"]    Project02Tag01
    Comment    Click Element    //button[text()="Tag"]
    Comment    Click Element    //span[text()="Project02Tag02"]
    Comment    Compare Field Content    //div[text()="Story02"]/../..//div[@class="x-grid3-cell-inner x-grid3-col-2"]    Project02Tag01,Project02Tag02
    [Teardown]    Test Tag - Add Mutiple Tags with Tag Button Teardown
Test Tag - Sprint Backlog Edit Story Not Edit Tags
    [Documentation]    Test if the tags is the same after editing story and not changing tags
    [Setup]    Test Tag - Sprint Backlog Setup    Project02
    ${Project02_OriginalTag}=    Get Text    xpath = //span[text()="7"]/../../../td[2]/div[1]
    ${StoryID}=    Set Variable    xpath = //span[text()="7"]
    Double Click Element    ${StoryID}
    Click Element    xpath = //button[text()="Submit"]
    ${Project02_NewTag}=    Get Text    xpath = //span[text()="7"]/../../../td[2]/div[1]
    Should Be Equal    ${Project02_OriginalTag}    ${Project02_NewTag}
    [Teardown]    Test Tag - Sprint Backlog Teardown

Test Tag - Sprint Backlog Edit Story Not Edit Tags Check Project01
    [Setup]    Test Tag - Sprint Backlog Setup    Project01
    ${Project01_OriginalTag}=    Get Text    xpath = //span[text()="7"]/../../../td[2]/div[1]
    ${ProjectList}=    Set Variable    xpath = //td[text()="ProjectList"]
    Click Element    ${ProjectList}
    Select Project    Project02
    Wait Until Page Contains Element    xpath = //span[text()="Sprint Backlog"]
    ${SprintBacklog}=    Set Variable    xpath=//span[text()="Sprint Backlog"]
    Click Element    ${SprintBacklog}
    ${Project02_OriginalTag}=    Get Text    xpath = //span[text()="7"]/../../../td[2]/div[1]
    ${StoryID}=    Set Variable    xpath = //span[text()="7"]
    Double Click Element    ${StoryID}
    Click Element    xpath = //button[text()="Submit"]
    ${Project02_NewTag}=    Get Text    xpath = //span[text()="7"]/../../../td[2]/div[1]
    Should Be Equal    ${Project02_OriginalTag}    ${Project02_NewTag}
    Click Element    ${ProjectList}
    Select Project    Project01
    Wait Until Page Contains Element    xpath = //span[text()="Sprint Backlog"]
    Click Element    ${SprintBacklog}
    ${Project01_NewTag}=    Get Text    xpath = //span[text()="7"]/../../../td[2]/div[1]
    Should Be Equal    ${Project01_OriginalTag}    ${Project01_NewTag}
    [Teardown]    Test Tag - Sprint Backlog Teardown
