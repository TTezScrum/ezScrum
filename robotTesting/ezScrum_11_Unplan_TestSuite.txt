*** Settings ***
Suite Setup       Test Unplan Suite Setup
Suite Teardown    Test Unplan Suite Teardown
Force Tags        Unplan
Resource          keywords/Unplan/ezScrum_Unplan_SetupTeardown.txt

*** Variables ***
@{addUnplanList}    1    Test Unplanned    1    account01    account02;account03    99    This is Unplanned Notes
...               ?    # 0 id, 1 name, 2 sprint id, 3 handler, 4 partners, 5 estimate, 6 notes, 7specific time
@{editUnplanList}    1    New Unplanned Name    1    account03    account02    50    New Unplanned Notes
...               30    assigned    ?    # 0 id, 1 name, 2 sprint id, 3 handler, 4 partners, 5 estimate, 6 notes, 7 actual, 8 status, 9 specific time
@{deleteUnplanList1}    1    Test Unplanned 1    1    account03    account02    99    This is Unplanned Notes 1
...               ?    # 0 id, 1 name, 2 sprint id, 3 handler, 4 partners, 5 estimate, 6 notes, 7specific time
@{deleteUnplanList2}    2    Test Unplanned 2    1    account03    account02    99    This is Unplanned Notes 2
...               ?    # 0 id, 1 name, 2 sprint id, 3 handler, 4 partners, 5 estimate, 6 notes, 7specific time
@{deleteUnplanList3}    3    Test Unplanned 3    1    account03    account02    99    This is Unplanned Notes 3
...               ?    # 0 id, 1 name, 2 sprint id, 3 handler, 4 partners, 5 estimate, 6 notes, 7specific time

*** Test Cases ***
Test Unplan - Add Unplan
    [Setup]    Test Unplan Add Setup
    Add Unplan    @{addUnplanList}
    # get data
    ${tcItems} =    Get Matching Xpath Count    //div[@id='UnplannedItem_Panel']//table[@class='x-grid3-row-table']
    ${actualId} =    Get Text    //div[@id='UnplannedItem_Panel']//div[@class='x-grid3-cell-inner x-grid3-col-0']
    ${actualName} =    Get Text    //div[@id='UnplannedItem_Panel']//div[@class='x-grid3-cell-inner x-grid3-col-1']
    ${actualSprintId} =    Get Text    //div[@id='UnplannedItem_Panel']//div[@class='x-grid3-cell-inner x-grid3-col-2']
    ${actualEstimate} =    Get Text    //div[@id='UnplannedItem_Panel']//div[@class='x-grid3-cell-inner x-grid3-col-3']
    ${actualStatus} =    Get Text    //div[@id='UnplannedItem_Panel']//div[@class='x-grid3-cell-inner x-grid3-col-4']
    ${actualActual} =    Get Text    //div[@id='UnplannedItem_Panel']//div[@class='x-grid3-cell-inner x-grid3-col-5']
    ${actualHandler} =    Get Text    //div[@id='UnplannedItem_Panel']//div[@class='x-grid3-cell-inner x-grid3-col-6']
    ${actualPartners} =    Get Text    //div[@id='UnplannedItem_Panel']//div[@class='x-grid3-cell-inner x-grid3-col-7']
    ${actualNotes} =    Get Text    //div[@id='UnplannedItem_Panel']//div[@class='x-grid3-cell-inner x-grid3-col-8']    # 0 id, 1 name, 2 sprint id, 3 handler, 4 partners, 5 estimate, 6 notes, 7specific time
    # assert
    Should Be Equal    1    ${tcItems}
    Should Be Equal    ${addUnplanList[0]}    ${actualId}
    Should Be Equal    ${addUnplanList[1]}    ${actualName}
    Should Be Equal    ${addUnplanList[2]}    ${actualSprintId}
    Should Be Equal    ${addUnplanList[3]}    ${actualHandler}
    Should Be Equal    ${addUnplanList[4]}    ${actualPartners}
    Should Be Equal    ${addUnplanList[5]}    ${actualEstimate}
    Should Be Equal    ${addUnplanList[6]}    ${actualNotes}
    Should Be Equal    ${addUnplanList[5]}    ${actualActual}
    Should Be Equal    new    ${actualStatus}
    [Teardown]    Test Unplan Add Teardown

Test Unplan - Edit Unplan
    [Setup]    Test Unplan Edit Setup
    Select Unplan    1    ${addUnplanList[1]}
    Edit Unplan    @{editUnplanList}
    # get data
    ${actualId} =    Get Text    //div[@id='UnplannedItem_Panel']//div[@class='x-grid3-cell-inner x-grid3-col-0']
    ${actualName} =    Get Text    //div[@id='UnplannedItem_Panel']//div[@class='x-grid3-cell-inner x-grid3-col-1']
    ${actualSprintId} =    Get Text    //div[@id='UnplannedItem_Panel']//div[@class='x-grid3-cell-inner x-grid3-col-2']
    ${actualEstimate} =    Get Text    //div[@id='UnplannedItem_Panel']//div[@class='x-grid3-cell-inner x-grid3-col-3']
    ${actualStatus} =    Get Text    //div[@id='UnplannedItem_Panel']//div[@class='x-grid3-cell-inner x-grid3-col-4']
    ${actualActual} =    Get Text    //div[@id='UnplannedItem_Panel']//div[@class='x-grid3-cell-inner x-grid3-col-5']
    ${actualHandler} =    Get Text    //div[@id='UnplannedItem_Panel']//div[@class='x-grid3-cell-inner x-grid3-col-6']
    ${actualPartners} =    Get Text    //div[@id='UnplannedItem_Panel']//div[@class='x-grid3-cell-inner x-grid3-col-7']
    ${actualNotes} =    Get Text    //div[@id='UnplannedItem_Panel']//div[@class='x-grid3-cell-inner x-grid3-col-8']    # 0 id, 1 name, 2 sprint id, 3 handler, 4 partners, 5 estimate, 6 notes, 7 actual, 8 status, 9 specific time
    # assert
    Should Be Equal    ${editUnplanList[0]}    ${actualId}
    Should Be Equal    ${editUnplanList[1]}    ${actualName}
    Should Be Equal    ${editUnplanList[2]}    ${actualSprintId}
    Should Be Equal    ${editUnplanList[3]}    ${actualHandler}
    Should Be Equal    ${editUnplanList[4]}    ${actualPartners}
    Should Be Equal    ${editUnplanList[5]}    ${actualEstimate}
    Should Be Equal    ${editUnplanList[6]}    ${actualNotes}
    Should Be Equal    ${editUnplanList[7]}    ${actualActual}
    Should Be Equal    ${editUnplanList[8]}    ${actualStatus}
    [Teardown]    Test Unplan Edit Teardown

Test Unplan - Delete Unplan
    [Setup]    Test Unplan Delete Setup
    # There 3 Unplan Items Before Delete Unplan
    ${unplannedItemPanel}=    Set Variable    //div[@id='UnplannedItem_Panel']//table[@class='x-grid3-row-table']
    Wait Until Element Is Visible    ${unplannedItemPanel}    1 min
    ${counts} =    Get Matching Xpath Count    ${unplannedItemPanel}
    Should Be Equal    3    ${counts}
    # Remains 2 Unplan Items after delete 1 Unplan Item
    Select Unplan    1    ${deleteUnplanList1[1]}
    Delete Unplan
    Wait Until Element Is Visible    ${unplannedItemPanel}    1 min
    ${counts} =    Get Matching Xpath Count    ${unplannedItemPanel}
    Should Be Equal    2    ${counts}
    # Remains 1 Unplan Items after delete 1 Unplan Item
    Select Unplan    1    ${deleteUnplanList2[1]}
    Delete Unplan
    Wait Until Element Is Visible    ${unplannedItemPanel}    1 min
    ${counts} =    Get Matching Xpath Count    ${unplannedItemPanel}
    Should Be Equal    1    ${counts}
    # Remains 0 Unplan Items after delete 1 Unplan Item
    Select Unplan    1    ${deleteUnplanList3[1]}
    Delete Unplan
    ${counts} =    Get Matching Xpath Count    ${unplannedItemPanel}
    Should Be Equal    0    ${counts}
    [Teardown]    Test Unplan Delete Teardown
