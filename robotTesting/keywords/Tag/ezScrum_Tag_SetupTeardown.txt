*** Settings ***
Library           ../lib/Selenium2Improved.py
Resource          ../../Global Define.txt
Resource          ../Project/ezScrum_Project.txt
Resource          ../../ServerConfig.txt

*** Keywords ***
Test Tag - ProductBacklog Add Tag with Edit Story in Proj. 01 Setup
    Set Selenium Speed    ${SELENIUM_SPEED}
    Open Browser    ${LOGIN_URL}    ${BROWSER}
    ${attachFilePath}=    Catenate    SEPARATOR=\\    ${EXECDIR}    TestData    Tag    TagTestTwoProjects.sql
    Load Database    ${DB_URL}    ${DB_NAME}    ${DB_ACCOUNT}    ${DB_PASSWORD}    ${attachFilePath}
    Maximize Browser Window
    Input Text    xpath=//input[@name="userId"]    admin
    Input Text    xpath=//input[@name="password"]    admin
    Click Button    xpath=//input[@id="Next"]
    #Select Project
    Click Element    xpath=//div[text()="Project01"]
    Wait Until Element Is Visible    xpath=//a[@class="x-tree-node-anchor"]/span[text()="Product Backlog"]    60
    Click Element    xpath=//a[@class="x-tree-node-anchor"]/span[text()="Product Backlog"]

Test Tag - ProductBacklog Add Tag with Edit Story in Proj. 01 Teardown
    Clean Database    ${DB_URL}    ${DB_ACCOUNT}    ${DB_PASSWORD}    ${DB_NAME}
    Close Browser

Test Tag - Sprint Backlog Setup
    [Arguments]    ${Project}
    #setup
    Open Browser    ${LOGIN_URL}    ${BROWSER}
    ${attachFilePath}=    Catenate    SEPARATOR=\\    ${EXECDIR}    TestData    Tag    TagTestTwoProjects.sql
    Load Database    ${DB_URL}    ${DB_NAME}    ${DB_ACCOUNT}    ${DB_PASSWORD}    ${attachFilePath}
    Maximize Browser Window
    _InputLoginForm    ${userName}    ${userPassword}
    #Select project
    Select Project    ${Project}
    Wait Until Page Contains Element    xpath = //span[text()="Sprint Backlog"]
    ${SprintBacklog}=    Set Variable    xpath=//span[text()="Sprint Backlog"]
    Click Element    ${SprintBacklog}

Test Tag - Sprint Backlog Teardown
    Clean DB    ${DB_URL}    ${DB_ACCOUNT}    ${DB_PASSWORD}    ${DB_NAME}
    Exit ezScrum System

Test Tag - ProductBacklog Setup
    Open Browser    ${LOGIN_URL}    ${BROWSER}
    ${attachFilePath}=    Catenate    SEPARATOR=\\    ${EXECDIR}    TestData    SprintBacklog    Printable_StoryEnable_and_TaskDisable.sql
    Load Database    ${DB_URL}    ${DB_NAME}    ${DB_ACCOUNT}    ${DB_PASSWORD}    ${attachFilePath}
    Maximize Browser Window
    Input Text    xpath=//input[@name="userId"]    admin
    Input Text    xpath=//input[@name="password"]    admin
    Click Button    xpath=//input[@id="Next"]
    #Select Project
    Click Element    xpath=//div[text()="TestProject"]
    Wait Until Element Is Visible    xpath=//a[@class="x-tree-node-anchor"]/span[text()="Sprint Backlog"]    60
    Click Element    xpath=//a[@class="x-tree-node-anchor"]/span[text()="Sprint Backlog"]

Test Tag - ProductBacklog Teardown
    Clean Database    ${DB_URL}    ${DB_ACCOUNT}    ${DB_PASSWORD}    ${DB_NAME}
    Close Browser

Test Tag - Add Mutiple Tags with Tag Button Setup
    Set Selenium Speed    ${SELENIUM_SPEED}
    Open Browser    ${LOGIN_URL}    ${BROWSER}
    ${attachFilePath}=    Catenate    SEPARATOR=\\    ${EXECDIR}    TestData    Tag    TagTestTwoProjects.sql
    Load Database    ${DB_URL}    ${DB_NAME}    ${DB_ACCOUNT}    ${DB_PASSWORD}    ${attachFilePath}
    Maximize Browser Window
    Input Text    xpath=//input[@name="userId"]    admin
    Input Text    xpath=//input[@name="password"]    admin
    Click Button    xpath=//input[@id="Next"]
    #Select Project
    Click Element    xpath=//div[text()="Project02"]
    Wait Until Element Is Visible    xpath=//a[@class="x-tree-node-anchor"]/span[text()="Product Backlog"]    60
    Click Element    xpath=//a[@class="x-tree-node-anchor"]/span[text()="Product Backlog"]

Test Tag - Add Mutiple Tags with Tag Button Teardown
    Clean Database    ${DB_URL}    ${DB_ACCOUNT}    ${DB_PASSWORD}    ${DB_NAME}
    Close Browser

Test Tag - Edit Tag Setup
    [Arguments]    ${Project}
    #setup
    Open Browser    ${LOGIN_URL}    ${BROWSER}
    ${attachFilePath}=    Catenate    SEPARATOR=\\    ${EXECDIR}    TestData    Tag    TagTestTwoProjects.sql
    Load Database    ${DB_URL}    ${DB_NAME}    ${DB_ACCOUNT}    ${DB_PASSWORD}    ${attachFilePath}
    Maximize Browser Window
    _InputLoginForm    ${userName}    ${userPassword}
    #Select project
    Select Project    ${Project}
    Wait Until Page Contains Element    xpath = //span[text()="Sprint Backlog"]
    ${ProductBacklog}=    Set Variable    xpath=//span[text()="Product Backlog"]
    Click Element    ${ProductBacklog}

Test Tag - Edit Tag Teardown
    Clean DB    ${DB_URL}    ${DB_ACCOUNT}    ${DB_PASSWORD}    ${DB_NAME}
    Exit ezScrum System

Test Tag - ProductBacklog Add Tag with Edit Story in Proj. 02 Setup
    Set Selenium Speed    ${SELENIUM_SPEED}
    Open Browser    ${LOGIN_URL}    ${BROWSER}
    ${attachFilePath}=    Catenate    SEPARATOR=\\    ${EXECDIR}    TestData    Tag    TagTestTwoProjects.sql
    Load Database    ${DB_URL}    ${DB_NAME}    ${DB_ACCOUNT}    ${DB_PASSWORD}    ${attachFilePath}
    Maximize Browser Window
    Input Text    xpath=//input[@name="userId"]    admin
    Input Text    xpath=//input[@name="password"]    admin
    Click Button    xpath=//input[@id="Next"]
    #Select Project
    Click Element    xpath=//div[text()="Project02"]
    Wait Until Element Is Visible    xpath=//a[@class="x-tree-node-anchor"]/span[text()="Product Backlog"]    60
    Click Element    xpath=//a[@class="x-tree-node-anchor"]/span[text()="Product Backlog"]

Test Tag - ProductBacklog Add Tag with Edit Story in Proj. 02 Teardown
    Clean Database    ${DB_URL}    ${DB_ACCOUNT}    ${DB_PASSWORD}    ${DB_NAME}
    Close Browser
